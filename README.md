# RestApiCarNum
![avatar](/img/api_avatar.jpg)
–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞:
–ï—Å—Ç—å –º–æ–¥–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è ML —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º. 
–ï–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ –≤–µ–±-—Å–µ—Ä–≤–∏—Å, 
–∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ REST API. 
–í —Å—Ç–æ—Ä–æ–Ω—É —Å–µ—Ä–≤–∏—Å–∞ –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö (–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö), 
–∞ –≤ –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—Ç–≤–µ—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ pick_regno. 
–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—É—é, –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É (500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É).

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞  
```
.
‚îú‚îÄ‚îÄ app/                   # –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
‚îú      ‚îÄ‚îÄ main.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
‚îú      ‚îÄ‚îÄ micromodel.cbm   # –ú–æ–¥–µ–ª—å –æ—Ç ML —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
‚îú      ‚îÄ‚îÄ pick_regno.py    # –°–∫—Ä–∏–ø—Ç –æ—Ç ML —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –º–æ–¥–µ–ª–∏.
‚îú      ‚îÄ‚îÄ test_data.csv    # –ù–µ–±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–∏—Å–∞.
‚îú      ‚îÄ‚îÄ test.py          # –°–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏.
‚îú‚îÄ‚îÄ img/                   # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
‚îú‚îÄ‚îÄ.gitignore              # –§–∞–π–ª—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ Git-–æ–º.
‚îú‚îÄ‚îÄ docker-compose.yaml    # –°–µ—Ä–≤–∏—Å—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞.
‚îú‚îÄ‚îÄ Dockerfile             # –ö–∞—Å—Ç–æ–º–Ω–∞—è —Å–±–æ—Ä–∫–∞.
‚îú‚îÄ‚îÄ locustfile             # –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API.
‚îú‚îÄ‚îÄ README.md              # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ.
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.
‚îî‚îÄ‚îÄ task_description.txt   # –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
```

### ‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
–°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å—Ä–µ–¥–µ **Docker** ‚Äî —ç—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –Ω–∏–∂–µ.  
**REST API**:
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å **CatBoost** –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç **POST-–∑–∞–ø—Ä–æ—Å** —Å JSON-–¥–∞–Ω–Ω—ã–º–∏ –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫–∞.
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é `pick_regno`.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

#### üîÑ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –º–æ–¥–µ–ª—å `CatBoost` –∑–∞–≥—Ä—É–∂–∞–ª–∞—Å—å –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `pick_regno`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è–ª–æ –¥–æ—Å—Ç–∏—á—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (500 RPS) –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

–ß—Ç–æ–±—ã —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É:
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –±—ã–ª–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø ‚Äî –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`@app.on_event("startup")`).
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ **—É—Å–∫–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤**.

### üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Docker
~~~
docker compose up
~~~

### üì° –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã  
üîß FastAPI    http://localhost:8000/	  
üìò Swagger UI http://localhost:8000/docs	  
üêç Locust	  http://localhost:8089/  

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ test_data.csv
–ó–∞—Ö–æ–¥–∏–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä restapicarnum-uvicorn-service:
~~~
docker exec -it <CONTAINER_ID> bash
~~~
–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
~~~
python test.py
~~~
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `–û041–í–í797 ‚Üí {'prediction': [0.9546576119624413, 0.0453423880375588]}`

### üìà –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Locust  
–û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:üëâ http://localhost:8089/  
–£–∫–∞–∑—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–≥—Ä—É–∑–∫–∏:  
Number of users: 800  
Spawn rate: 200  
–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –∏ –ø–æ–ª—É—á–∞–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ RPS.
![RPS](/img/locust_test.png)

